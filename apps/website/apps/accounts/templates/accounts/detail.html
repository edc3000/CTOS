{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="account-detail-container">
  <div class="account-header">
    <div class="breadcrumb">
      <a href="{% url 'account_list' %}">è´¦æˆ·åˆ—è¡¨</a>
      <span class="separator">></span>
      <span class="current">{{ account_info.exchange|upper }} è´¦æˆ· {{ account_info.account_id }}</span>
    </div>
    
    <div class="account-info">
      <h2>{{ account_info.exchange|upper }} è´¦æˆ· {{ account_info.account_id }}</h2>
      <div class="account-stats">
        <div class="stat-item">
          <span class="stat-label">ä½™é¢:</span>
          <span class="stat-value">{{ account_info.balance|floatformat:2 }} USDT</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">çŠ¶æ€:</span>
          <span class="stat-value status-{{ account_info.status|lower }}">
            {{ account_info.status }}
          </span>
        </div>
      </div>
    </div>
  </div>

  {% if error %}
  <div class="error-message">
    <h3>é”™è¯¯ä¿¡æ¯</h3>
    <p>{{ error }}</p>
  </div>
  {% endif %}

  <div class="detail-tabs">
    <div class="tab-nav">
      <button class="tab-btn active" data-tab="positions">ä»“ä½ä¿¡æ¯</button>
      <button class="tab-btn" data-tab="orders">è®¢å•ä¿¡æ¯</button>
    </div>

    <div class="tab-content">
      <!-- ä»“ä½ä¿¡æ¯æ ‡ç­¾é¡µ -->
      <div class="tab-panel active" id="positions-panel">
        <div class="panel-header">
          <h3>å½“å‰ä»“ä½</h3>
          <div class="panel-controls">
            <button id="refresh-positions" class="btn btn-primary">
              <span class="refresh-icon">ğŸ”„</span>
              åˆ·æ–°ä»“ä½
            </button>
            <div class="auto-refresh">
              <label>
                <input type="checkbox" id="auto-refresh-positions">
                è‡ªåŠ¨åˆ·æ–° (30ç§’)
              </label>
            </div>
          </div>
        </div>
        
        <div class="table-container">
          <table class="data-table" id="positions-table">
            <thead>
              <tr>
                <th>äº¤æ˜“å¯¹</th>
                <th>æ–¹å‘</th>
                <th>æ•°é‡</th>
                <th>å¼€ä»“ä»·æ ¼</th>
                <th>æ ‡è®°ä»·æ ¼</th>
                <th>æœªå®ç°ç›ˆäº</th>
                <th>å·²å®ç°ç›ˆäº</th>
                <th>æ æ†</th>
                <th>å¼ºå¹³ä»·æ ¼</th>
              </tr>
            </thead>
            <tbody id="positions-tbody">
              <tr>
                <td colspan="9" class="loading-cell">åŠ è½½ä¸­...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- è®¢å•ä¿¡æ¯æ ‡ç­¾é¡µ -->
      <div class="tab-panel" id="orders-panel">
        <div class="panel-header">
          <h3>å½“å‰è®¢å•</h3>
          <div class="panel-controls">
            <button id="refresh-orders" class="btn btn-primary">
              <span class="refresh-icon">ğŸ”„</span>
              åˆ·æ–°è®¢å•
            </button>
            <div class="auto-refresh">
              <label>
                <input type="checkbox" id="auto-refresh-orders">
                è‡ªåŠ¨åˆ·æ–° (30ç§’)
              </label>
            </div>
          </div>
        </div>
        
        <div class="table-container">
          <table class="data-table" id="orders-table">
            <thead>
              <tr>
                <th>è®¢å•ID</th>
                <th>äº¤æ˜“å¯¹</th>
                <th>ç±»å‹</th>
                <th>æ–¹å‘</th>
                <th>æ•°é‡</th>
                <th>ä»·æ ¼</th>
                <th>çŠ¶æ€</th>
                <th>åˆ›å»ºæ—¶é—´</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody id="orders-tbody">
              <tr>
                <td colspan="9" class="loading-cell">åŠ è½½ä¸­...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="{% static 'js/account-detail.js' %}"></script>
<script>
  // ä¼ é€’è´¦æˆ·ä¿¡æ¯ç»™JavaScript
  window.accountInfo = {
    exchange: '{{ account_info.exchange }}',
    accountId: {{ account_info.account_id }},
    balance: {{ account_info.balance }},
    status: '{{ account_info.status }}'
  };
</script>
{% endblock %}
